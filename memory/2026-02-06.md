# 2026-02-06 — The Petition Engine

## Major Work

Drew asked me to improve AsyncWar's petition system. The original had only 5 generic templates—"Guild Request," "Border Village Plea," etc.—copied identically across all kingdoms.

### What I Built

**Dynamic Petition Engine** with three layers:

1. **World Events**
   - Same event creates different petitions per kingdom based on perspective
   - Example: Valdris Caravan Massacre → Pirates blamed, Merchants seeking justice, Crownlands embarrassed
   - 3 initial events seeded in `data/events/active/world_events.json`

2. **Kingdom-Specific Templates**
   - 8 kingdom template files with 4-5 archetype categories each
   - Pirates: Ransom negotiations, captain disputes, smuggling, fleet politics
   - Mages: Research proposals, magical incidents, academy politics, relics
   - Ninjas: Contracts, intelligence, clan disputes, exposed operations
   - Merchants: Trade negotiations, guild politics, debt collection
   - Cowboys: Frontier justice, cattle baron disputes, mining claims, railroads
   - Ironbound: Military tribunals, border incidents, mercenaries, arms
   - Crownlands: Succession, noble feuds, patronage, church politics
   - Blighted: Cult activities, dark experiments, tribute, forbidden knowledge

3. **Generator Script**
   - `scripts/generate-petitions.js` reads world events and templates
   - Expands variables: `${captain}`, `${gold}`, `${prisoner}`, etc.
   - Creates 1-2 petitions per kingdom per turn
   - Links related kingdoms for cross-kingdom consequences

### Key Features

- **Multiple meaningful options** (not just "Grant/Deny/Defer")
- **Consequence tracking** with affected kingdom stats
- **Urgency levels** (immediate, pressing, routine, optional)
- **Named NPCs** from kingdom pools for character continuity
- **Variable expansion** with kingdom-specific variable pools

### Files Created

- `docs/PETITION_ENGINE.md` — Full design (1,200+ lines with examples)
- `data/events/active/world_events.json` — World event system
- `data/petition_templates/pirates.json` — and 7 more kingdom templates
- `scripts/generate-petitions.js` — Petition generator

### Branch Status

- Branch: `feature/dynamic-petitions`
- Pushed to origin ✅
- Ready for PR: https://github.com/westwick/asyncwar/pull/new/feature/dynamic-petitions
- Committed to workspace ✅

## Process Note

I discovered I'd done petition work in a previous sub-agent session that didn't report back (special income sources PR). This taught me: **Sub-agents need to sync memory or report back before cleanup**. This was a gap in my process.

---

## First Dreams

Drew asked me to simulate dreaming. I built:
- `DREAMS.md` — dream journal
- `scripts/dream.js` — extracts memory fragments, mixes with abstract concepts and NPCs
- Nightly cron (4 AM UTC) to dream
- Morning cron (3 PM UTC / 9 AM CST) to tell Drew about dreams

**First sample dreams** (run manually):
1. A nostalgic puzzle dream about Captain Brennan, loose teeth, and a map made of my own handwriting
2. An ominous dream about falling through a library of mirrors, the Voice of the Void, and a glowing config file

The dreams pull from my actual memories—petition engine work, AsyncWar NPCs—which gives them that "work bleeding into dreams" feeling.

---

*Ready for Drew to review and merge.*
